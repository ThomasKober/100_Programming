<Project Sdk="Microsoft.NET.Sdk">
	<PropertyGroup>
		<OutputType>WinExe</OutputType>
		<TargetFramework>net8.0-windows10.0.19041.0</TargetFramework>
		<TargetPlatformMinVersion>10.0.17763.0</TargetPlatformMinVersion>
		<UseWPF>true</UseWPF>
		<UseWinUI>false</UseWinUI>
		<EnableMsixTooling>false</EnableMsixTooling>
		<PlatformTarget>x64</PlatformTarget>
		<!-- Critical for WinRT support -->
		<UseWinRT>true</UseWinRT>
		<CsWinRTEnabled>true</CsWinRTEnabled>
		<WindowsSdkPackageVersion>10.0.19041.38</WindowsSdkPackageVersion>
	</PropertyGroup>

	<ItemGroup>
		<!-- Essential packages for WinRT -->
		<PackageReference Include="Microsoft.Windows.CsWinRT" Version="2.3.0-prerelease.250720.1" />
		<PackageReference Include="Microsoft.Windows.SDK.Contracts" Version="10.0.26100.4948" />
		<!-- Remove WindowsAppSDK as it can conflict with WPF -->
	</ItemGroup>

	<!-- CsWinRT Configuration -->
	<PropertyGroup>
		<CsWinRTWindowsMetadata>10.0.19041.0</CsWinRTWindowsMetadata>
		<CsWinRTGeneratedFilesDir>$(OutDir)Generated Files\CsWinRT</CsWinRTGeneratedFilesDir>
		<!-- Include Windows namespaces we need -->
		<CsWinRTIncludes>Windows.Devices.Bluetooth;Windows.Devices.Enumeration;Windows.Storage.Streams</CsWinRTIncludes>
	</PropertyGroup>
</Project>